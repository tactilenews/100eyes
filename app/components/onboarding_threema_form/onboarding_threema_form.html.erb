<%= c 'stack', **attrs do %>

  <%= c 'stack', class: 'text-serif', space: :xsmall do %>
    <%= c 'heading', tag: :h1 do %>
      <%= t 'components.onboarding_threema_form.heading' %>
    <% end %>

    <p><%= t 'components.onboarding_threema_form.text' %></p>
  <% end %>

  <%= form_with(model: @contributor, local: true, url: onboarding_threema_path) do %>
    <%= c 'stack' do %>
      <%= c 'field', object: @contributor, attr: :first_name do |field| %>
        <%= c 'input', field.input_defaults.merge(required: true) %>
      <% end %>

      <%= c 'field', object: @contributor, attr: :last_name do |field| %>
        <%= c 'input', field.input_defaults.merge(required: true) %>
      <% end %>

      <%= c 'field', object: @contributor, attr: :threema_id do |field| %>
        <%= c 'threema_id_input', field.input_defaults.merge(required: true) %>
      <% end %>

      <%= c('field',
        object: @contributor,
        attr: :data_processing_consent,
        help: I18n.t('contributor.form.data_processing_consent.help', link: data_protection_link).html_safe,
        style: :leftAligned
      ) do |field| %>
        <%= c 'checkbox', **field.input_defaults, required: true %>
      <% end %>

      <% if Setting.onboarding_ask_for_additional_consent && Setting.onboarding_additional_consent_defined? %>
        <%= c('field',
          object: contributor,
          attr: :additional_consent,
          styles: [:horizontal, :leftAligned],
          label: Setting.onboarding_additional_consent_heading,
          help: Setting.onboarding_additional_consent_text
        ) do |field| %>
          <%= c 'checkbox', field.input_defaults %>
        <% end %>
      <% end %>

      <%= c 'button',
        type: 'submit',
        label: t('components.onboarding_threema_form.submit'),
        styles: [:primary, :block]
      %>
    <% end %>
  <% end %>

<% end %>
